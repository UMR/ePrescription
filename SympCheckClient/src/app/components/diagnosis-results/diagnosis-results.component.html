<div class="diagnosis-results">
  <div *ngIf="!conditions || conditions.length === 0" class="no-results">
    <p>No diagnosis results available.</p>
  </div>

  <div *ngIf="conditions && conditions.length > 0">
    <h2>Diagnosis</h2>
    <div class="conditions-list">
      <div *ngFor="let condition of conditions; let i = index" class="condition-item">
        <button
          type="button"
          (click)="toggleCondition(i)"
          class="condition-header"
          [class.expanded]="isExpanded(i)"
        >
          <div class="condition-title">
            <div class="title-info">
              <h3>{{ condition.label }}</h3>
              <span class="physician-badge" *ngIf="condition.physician">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
                {{ condition.physician }}
              </span>
            </div>
            <div class="score-badge" 
                 [class.high-risk]="condition.score * 100 >= 70"
                 [class.medium-risk]="condition.score * 100 >= 50 && condition.score * 100 < 70"
                 [class.low-risk]="condition.score * 100 < 50">
              {{ (condition.score * 100).toFixed(1) }}%
            </div>
          </div>
          <span class="toggle-icon">▼</span>
        </button>

        <div *ngIf="isExpanded(i)" class="condition-details">
          <div *ngIf="condition.isEmergency" class="emergency-card" role="alert">
            <div class="emergency-icon">⚠️</div>
            <div>
              <h4>Emergency Warning</h4>
              <p>This condition may require urgent medical attention.</p>
            </div>
          </div>

          <div class="detail-section">
            <h4>ICD Code</h4>
            <p>{{ condition.icd }}</p>
          </div>

          <div class="detail-section">
            <h4>Details</h4>
            <p>{{ condition.details }}</p>
          </div>

          <div class="detail-section reasoning-section">
            <h4>
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
              </svg>
              Clinical Reasoning
            </h4>
            <p>{{ condition.reasoning }}</p>
          </div>

          <button type="button" (click)="viewDetails(condition.label)" class="btn-details">
            View Full Details
          </button>
        </div>
      </div>
    </div>

    <!-- Disclaimer Card -->
    <div class="disclaimer-card">
      <div class="disclaimer-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
        </svg>
      </div>
      <div class="disclaimer-content">
        <h4>Important Notice</h4>
        <p>This is not a diagnosis, rather an AI-based analysis. Please consider taking advice from actual specialists.</p>
      </div>
    </div>
  </div>
</div>
